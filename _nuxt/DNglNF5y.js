import{_ as R}from"./BUSItsXT.js";import{_ as H}from"./B9a6rt6W.js";import{_ as O}from"./9kUDjqgu.js";import{r as i,C as W,H as M,c as r,a as e,l as V,b as d,n as s,k as E,F as X,m as G,y as I,t as f,p as J,q as h,v as w,x as T,T as K,o as a}from"./DSVZJnba.js";import{F as S}from"./Bc09wRms.js";import{P as Q}from"./D9u2-5lG.js";import{T as Y}from"./CAblKD2E.js";import{X as Z}from"./neRWB7_o.js";import"./CqshNR8s.js";import"./ME1vAZHe.js";import"./DlAUqK2U.js";import"./qQsMwbb5.js";import"./eTiOZxs9.js";const ee={class:"space-y-8"},te={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},se={key:0,class:"text-center py-20"},le={key:1,class:"text-center py-20 border border-dashed border-white/10 rounded-2xl"},oe={key:2,class:"space-y-4"},ne={class:"w-24 h-16 shrink-0 bg-slate-800 rounded-lg overflow-hidden"},ie=["src","alt"],ae={key:1,class:"w-full h-full flex items-center justify-center"},re={class:"flex-1 min-w-0"},de={class:"text-white font-medium text-lg truncate"},ue={class:"text-slate-500 text-sm truncate"},ce={class:"flex items-center gap-4"},me={class:"text-slate-500 text-sm hidden md:block"},pe={class:"flex gap-2"},fe=["onClick"],xe=["onClick"],ge={key:0,class:"fixed inset-0 z-[100] flex items-center justify-center px-4"},be={class:"relative w-full max-w-2xl bg-slate-900 border border-white/10 rounded-2xl shadow-2xl p-6 overflow-hidden max-h-[90vh] overflow-y-auto"},ve={class:"flex justify-between items-center mb-6"},he={class:"text-xl font-display font-bold text-white"},we={class:"space-y-1"},ye={class:"space-y-1"},_e={class:"space-y-1"},ke={class:"space-y-1"},Ce={class:"space-y-1"},Pe={class:"flex items-center justify-between p-4 bg-slate-950/50 rounded-xl border border-white/5"},$e={class:"pt-4 flex gap-3"},De=["disabled"],qe={__name:"blogs",setup(Te){const k=i([]),C=i(!0),u=i(!1),c=i(!1),y=i(!1),x=i(!1),g=i(null),P=i(null),m=i(""),p=i(""),b=i("success"),v=i(1),$=i(0),U=i(10),n=i({id:null,title:"",slug:"",coverImage:"",excerpt:"",content:"",published:!1});W(()=>{_()});const _=async()=>{C.value=!0;try{const o=await $fetch("/api/blogs",{params:{page:v.value,limit:U.value}});k.value=o.data,$.value=o.meta.total}catch(o){console.error("Failed to fetch posts:",o)}finally{C.value=!1}};M(v,()=>{_()});const D=(o=null)=>{o?(c.value=!0,n.value={id:o.id,title:o.title,slug:o.slug,coverImage:o.coverImage||"",excerpt:o.excerpt||"",content:o.content||"",published:!!o.publishedAt}):(c.value=!1,n.value={id:null,title:"",slug:"",coverImage:"",excerpt:"",content:"",published:!1}),u.value=!0},B=async()=>{y.value=!0;try{c.value?(await $fetch(`/api/blogs/${n.value.id}`,{method:"PUT",body:n.value}),m.value="Updated",p.value="Blog post updated successfully."):(await $fetch("/api/blogs",{method:"POST",body:n.value}),m.value="Created",p.value="Blog post created successfully."),b.value="success",u.value=!1,_()}catch(o){m.value="Error",p.value="Failed to save post.",b.value="error",console.error(o)}finally{y.value=!1,P.value.show()}},F=o=>{g.value=o,x.value=!0},j=async()=>{if(g.value)try{await $fetch(`/api/blogs/${g.value.id}`,{method:"DELETE"}),m.value="Deleted",p.value="Blog post deleted.",b.value="success",_()}catch{m.value="Error",p.value="Failed to delete post.",b.value="error"}finally{x.value=!1,g.value=null,P.value.show()}},A=o=>o?new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Unknown";return M(()=>n.value.title,o=>{c.value||(n.value.slug=o.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim())}),(o,t)=>{const L=R,N=H,z=O;return a(),r("div",ee,[e("div",te,[t[13]||(t[13]=e("div",null,[e("h1",{class:"text-3xl font-display font-bold text-white mb-2"},"Blog Posts"),e("p",{class:"text-slate-400"},"Manage blog content for the public website.")],-1)),e("button",{onClick:t[0]||(t[0]=l=>D()),class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-sm font-medium shadow-lg shadow-indigo-500/20 transition-all"}," + New Post ")]),s(C)?(a(),r("div",se,[...t[14]||(t[14]=[e("div",{class:"w-8 h-8 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin mx-auto"},null,-1),e("p",{class:"text-slate-500 mt-4"},"Loading posts...",-1)])])):s(k).length===0?(a(),r("div",le,[d(s(S),{class:"w-12 h-12 text-slate-500 mx-auto mb-4"}),t[15]||(t[15]=e("p",{class:"text-slate-400 mb-2"},"No blog posts yet",-1)),e("button",{onClick:t[1]||(t[1]=l=>D()),class:"text-indigo-400 hover:text-indigo-300 text-sm font-medium"}," Create your first post ")])):(a(),r("div",oe,[(a(!0),r(X,null,G(s(k),l=>(a(),r("div",{key:l.id,class:"p-6 rounded-2xl bg-slate-900/40 border border-white/5 hover:border-indigo-500/30 transition-all flex flex-col md:flex-row md:items-center gap-4"},[e("div",ne,[l.coverImage?(a(),r("img",{key:0,src:l.coverImage,alt:l.title,class:"w-full h-full object-cover"},null,8,ie)):(a(),r("div",ae,[d(s(S),{class:"w-6 h-6 text-slate-600"})]))]),e("div",re,[e("h3",de,f(l.title),1),e("p",ue,f(l.slug),1)]),e("div",ce,[e("span",{class:T(["px-3 py-1 text-xs font-medium rounded-full",l.publishedAt?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400"])},f(l.publishedAt?"Published":"Draft"),3),e("span",me,f(A(l.createdAt)),1),e("div",pe,[e("button",{onClick:q=>D(l),class:"p-2 text-slate-400 hover:text-white hover:bg-white/10 rounded-lg transition-colors",title:"Edit"},[d(s(Q),{class:"w-4 h-4"})],8,fe),e("button",{onClick:q=>F(l),class:"p-2 text-slate-400 hover:text-rose-500 hover:bg-rose-500/10 rounded-lg transition-colors",title:"Delete"},[d(s(Y),{class:"w-4 h-4"})],8,xe)])])]))),128)),s($)>0?(a(),V(L,{key:0,"current-page":s(v),"onUpdate:currentPage":t[2]||(t[2]=l=>I(v)?v.value=l:null),total:s($),"items-per-page":s(U)},null,8,["current-page","total","items-per-page"])):E("",!0)])),(a(),V(K,{to:"body"},[s(u)?(a(),r("div",ge,[e("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:t[3]||(t[3]=l=>u.value=!1)}),e("div",be,[e("div",ve,[e("h3",he,f(s(c)?"Edit Post":"Create Post"),1),e("button",{onClick:t[4]||(t[4]=l=>u.value=!1),class:"text-slate-400 hover:text-white"},[d(s(Z),{class:"w-5 h-5"})])]),e("form",{class:"space-y-4",onSubmit:J(B,["prevent"])},[e("div",we,[t[16]||(t[16]=e("label",{class:"text-sm font-medium text-slate-300"},"Title",-1)),h(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>s(n).title=l),required:"",type:"text",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all"},null,512),[[w,s(n).title]])]),e("div",ye,[t[17]||(t[17]=e("label",{class:"text-sm font-medium text-slate-300"},"Slug",-1)),h(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>s(n).slug=l),required:"",type:"text",placeholder:"url-friendly-slug",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all"},null,512),[[w,s(n).slug]])]),e("div",_e,[t[18]||(t[18]=e("label",{class:"text-sm font-medium text-slate-300"},"Cover Image URL",-1)),h(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>s(n).coverImage=l),type:"url",placeholder:"https://...",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all"},null,512),[[w,s(n).coverImage]])]),e("div",ke,[t[19]||(t[19]=e("label",{class:"text-sm font-medium text-slate-300"},"Excerpt",-1)),h(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=l=>s(n).excerpt=l),rows:"2",placeholder:"A brief summary of the post...",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all resize-none"},null,512),[[w,s(n).excerpt]])]),e("div",Ce,[t[20]||(t[20]=e("label",{class:"text-sm font-medium text-slate-300"},"Content (Markdown)",-1)),h(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=l=>s(n).content=l),required:"",rows:"10",placeholder:"Write your post content in Markdown...",class:"w-full bg-slate-950 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm font-mono focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/50 transition-all resize-none"},null,512),[[w,s(n).content]]),t[21]||(t[21]=e("p",{class:"text-xs text-slate-500"},"Supports Markdown: **bold**, *italic*, # headers, etc.",-1))]),e("div",Pe,[t[22]||(t[22]=e("div",null,[e("p",{class:"text-sm font-medium text-white"},"Publish Now"),e("p",{class:"text-xs text-slate-500"},"Make this post visible on the public website")],-1)),e("button",{type:"button",onClick:t[10]||(t[10]=l=>s(n).published=!s(n).published),class:T(["w-12 h-7 rounded-full relative transition-colors",s(n).published?"bg-indigo-600":"bg-slate-700"])},[e("div",{class:T(["absolute top-1 w-5 h-5 bg-white rounded-full transition-all duration-300",s(n).published?"right-1":"left-1"])},null,2)],2)]),e("div",$e,[e("button",{type:"button",onClick:t[11]||(t[11]=l=>u.value=!1),class:"flex-1 px-4 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 text-white text-sm font-medium border border-white/5 transition-colors"}," Cancel "),e("button",{type:"submit",disabled:s(y),class:"flex-1 px-4 py-2.5 rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-medium shadow-lg shadow-indigo-500/20 transition-all disabled:opacity-70"},f(s(y)?"Saving...":s(c)?"Save Changes":"Create Post"),9,De)])],32)])])):E("",!0)])),d(N,{modelValue:s(x),"onUpdate:modelValue":t[12]||(t[12]=l=>I(x)?x.value=l:null),title:"Delete Post",description:`Are you sure you want to delete '${s(g)?.title}'? This action cannot be undone.`,"confirm-text":"Delete",onConfirm:j},null,8,["modelValue","description"]),d(z,{ref_key:"toastRef",ref:P,title:s(m),message:s(p),type:s(b)},null,8,["title","message","type"])])}}};export{qe as default};
